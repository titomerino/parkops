{% extends "shell/base.html" %}

{% block title %}ParkOps / Salida{% endblock %}
{% block page_title %}Parking salidas{% endblock %}

{% block content %}

{% include 'shell/partials/_messages_alert.html' with messages=messages %}

<!-- Card principal -->
<div class="card bg-dark text-light border-0 shadow-lg rounded-4">

    <div class="card-body p-4">

        <!-- Badge tipo de cobro -->
        {% if billing_type %}
        <div class="alert
            {% if is_monthly %}alert-warning
            {% elif is_daily %}alert-info
            {% else %}alert-success{% endif %}
            d-flex align-items-center small py-2"
        >
            <i class="bi
                {% if is_monthly %}bi-calendar-check-fill
                {% elif is_daily %}bi-sun-fill
                {% else %}bi-clock-fill{% endif %}
                me-2"
            ></i>

            <div>
                {% if is_monthly %}
                    Suscripción mensual activa
                {% elif is_daily %}
                    Suscripción diaria (monto fijo)
                {% else %}
                    Cobro por horas
                {% endif %}
            </div>
        </div>
        {% endif %}

        <!-- Placa -->
        <div class="text-center mb-3">
            <div class="text-muted small">Vehículo</div>
            <div class="display-6 fw-bold tracking-wide">
                {{ entry.plate }}
            </div>
        </div>

        <!-- Monto destacado -->
        <div class="bg-black-custom rounded-4 p-3 text-center mb-3">
            <div class="text-muted small">
                {% if is_monthly %}
                    Monto del día
                {% elif is_daily %}
                    Monto diario
                {% else %}
                    Total a pagar
                {% endif %}
            </div>

            <div class="display-5 fw-bold text-success">
                ${{ amount|floatformat:2 }}
            </div>
        </div>

        <!-- Detalles -->
        <div class="row small text-muted mb-3">
            <div class="col-6">
                <i class="bi bi-clock-history me-1"></i>
                Entrada<br>
                <strong class="text-light">
                    {{ entry.entry_date_hour|date:"d/m/Y h:i A" }}
                </strong>
            </div>

            <div class="col-6 text-end">
                <i class="bi bi-hourglass-split me-1"></i>
                Tiempo<br>
                <strong class="text-light">
                    {{ hours }} horas
                </strong>
            </div>
        </div>

        <!-- Form -->
        <form method="POST">
            {% csrf_token %}

            <button class="btn btn-success w-100 rounded-pill shadow-sm">
                <i class="bi bi-cash-coin me-1"></i>

                {% if is_monthly %}
                    Confirmar salida
                {% elif is_daily %}
                    Cobrar diario y salir
                {% else %}
                    Cobrar y salir
                {% endif %}
            </button>
        </form>

    </div>
</div>

<!-- Tip -->
<div class="text-center small text-muted mt-3">
    Toque una vez para confirmar
</div>

{% endblock %}

{% block menu_bottom %}
    {% include 'parking/partials/_parking_menu_bottom.html' %}
{% endblock %}
